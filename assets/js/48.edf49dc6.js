(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{354:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-各浏览器使用的-javascript-引擎以及它们的异同点、如何在代码中进行区分。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-各浏览器使用的-javascript-引擎以及它们的异同点、如何在代码中进行区分。","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 各浏览器使用的 JavaScript 引擎以及它们的异同点、如何在代码中进行区分。")]),t._v(" "),a("h2",{attrs:{id:"_2-请求数据到请求结束与服务器进行了几次交互。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-请求数据到请求结束与服务器进行了几次交互。","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 请求数据到请求结束与服务器进行了几次交互。")]),t._v(" "),a("h2",{attrs:{id:"_3-可详细描述浏览器从输入-url-到页面展现的详细过程。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-可详细描述浏览器从输入-url-到页面展现的详细过程。","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 可详细描述浏览器从输入 URL 到页面展现的详细过程。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/yuanzhiguo/p/8119470.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("从输入URL到浏览器显示页面发生了什么"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_4-浏览器解析html代码的原理，以及构建-dom-树的流程。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-浏览器解析html代码的原理，以及构建-dom-树的流程。","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 浏览器解析HTML代码的原理，以及构建 DOM 树的流程。")]),t._v(" "),a("h2",{attrs:{id:"_5-浏览器如何解析-css-规则，并将其应用到-dom-树上。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-浏览器如何解析-css-规则，并将其应用到-dom-树上。","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 浏览器如何解析 CSS 规则，并将其应用到 DOM 树上。")]),t._v(" "),a("h2",{attrs:{id:"_6-浏览器如何将解析好的带有样式的dom树进行绘制。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-浏览器如何将解析好的带有样式的dom树进行绘制。","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. 浏览器如何将解析好的带有样式的DOM树进行绘制。")]),t._v(" "),a("h2",{attrs:{id:"_7-浏览器的运行机制，如何配置资源异步同步加载。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-浏览器的运行机制，如何配置资源异步同步加载。","aria-hidden":"true"}},[t._v("#")]),t._v(" 7. 浏览器的运行机制，如何配置资源异步同步加载。")]),t._v(" "),a("h2",{attrs:{id:"_8-浏览器回流与重绘的底层原理，引发原因，如何有效避免。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-浏览器回流与重绘的底层原理，引发原因，如何有效避免。","aria-hidden":"true"}},[t._v("#")]),t._v(" 8. 浏览器回流与重绘的底层原理，引发原因，如何有效避免。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://qiniu.mdnice.com/01ad76b52063b38398ffde4cade3edb9.png",alt:"浏览器的渲染过程"}})]),t._v(" "),a("h3",{attrs:{id:"浏览器的渲染过程："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的渲染过程：","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器的渲染过程：")]),t._v(" "),a("ol",[a("li",[t._v("解析 "),a("code",[t._v("HTML")]),t._v(" 树生成 "),a("code",[t._v("DOM")]),t._v(" 树，解析 "),a("code",[t._v("CSS")]),t._v(" 生成 "),a("code",[t._v("CSSOM")]),t._v(" 树。")]),t._v(" "),a("li",[t._v("将 "),a("code",[t._v("DOM")]),t._v(" 树和 "),a("code",[t._v("CSSOM")]),t._v(" 树结合生成渲染树 "),a("code",[t._v("renderTree")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("Layout（回流）")]),t._v("：根据生成的 "),a("code",[t._v("renderTree")]),t._v(" 进行回流（"),a("code",[t._v("Layout")]),t._v("），得到节点的几何信息（位置、大小）。")]),t._v(" "),a("li",[a("code",[t._v("Painting（重绘）")]),t._v("：根据 "),a("code",[t._v("renderTree")]),t._v(" 以及回流 "),a("code",[t._v("Layout")]),t._v(" 得到节点的绝对像素。")]),t._v(" "),a("li",[a("code",[t._v("Display")]),t._v("：将像素发送给 "),a("strong",[t._v("GPU")]),t._v(" 线程，展示在页面上。")])]),t._v(" "),a("h4",{attrs:{id:"生成渲染树-rendertree"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成渲染树-rendertree","aria-hidden":"true"}},[t._v("#")]),t._v(" 生成渲染树 - renderTree")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://qiniu.mdnice.com/879265b75b6f3681721fff44b582b4ef.png",alt:"image"}})]),t._v(" "),a("p",[t._v("为了构建渲染树，浏览器主要完成了以下工作。")]),t._v(" "),a("ul",[a("li",[t._v("从 "),a("code",[t._v("DOM")]),t._v(" 树的根节点开始遍历每个可见节点。")]),t._v(" "),a("li",[t._v("对于每个可见的节点，找到 "),a("code",[t._v("CSSOM")]),t._v(" 树中对应的规则，并应用它们。")]),t._v(" "),a("li",[t._v("根据每个可见节点以及其对应的样式，组合生成渲染树。")])]),t._v(" "),a("p",[t._v("第一步中，既然说到了要遍历可见的节点，那么我们得先知道，什么节点是不可见的。不可见的节点包括：")]),t._v(" "),a("ul",[a("li",[t._v("一些不会渲染输出的节点，比如 "),a("code",[t._v("script")]),t._v("、"),a("code",[t._v("meta")]),t._v("、"),a("code",[t._v("link")]),t._v(" 等。")]),t._v(" "),a("li",[t._v("一些通过 "),a("code",[t._v("css")]),t._v(" 进行隐藏的节点。比如 "),a("code",[t._v("display:none")]),t._v("。（注意，利用 "),a("code",[t._v("visibility")]),t._v(" 和 "),a("code",[t._v("opacity")]),t._v(" 隐藏的节点，还是会显示在渲染树上的，只有 "),a("code",[t._v("display:none;")]),t._v(" 的节点才不会显示在渲染树上。）")])]),t._v(" "),a("h4",{attrs:{id:"回流-layout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回流-layout","aria-hidden":"true"}},[t._v("#")]),t._v(" 回流 - Layout")]),t._v(" "),a("p",[t._v("前面我们通过构造渲染树 "),a("code",[t._v("renderTree")]),t._v("，我们将可见 "),a("code",[t._v("DOM")]),t._v(" 节点以及它对应的样式结合起来，可是我们还需要计算它们在设备视口("),a("code",[t._v("viewport")]),t._v(")内的确切位置和大小，这个计算的阶段就是"),a("strong",[t._v("回流")]),t._v("。")]),t._v(" "),a("p",[t._v("为了弄清每个对象在网站上的确切大小和位置，浏览器从渲染树的根节点开始遍历,而在回流这个阶段，我们就需要根据视口具体的宽度，将其转为实际的像素值。")]),t._v(" "),a("h4",{attrs:{id:"重绘-painting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重绘-painting","aria-hidden":"true"}},[t._v("#")]),t._v(" 重绘 - Painting")]),t._v(" "),a("p",[t._v("通过回流("),a("code",[t._v("Layout")]),t._v(")阶段，我们知道了所有的可见节点的样式和具体的几何信息(位置、大小)，那么我们就可以将渲染树的每个节点都转换为屏幕上的实际像素，这个阶段就叫做"),a("strong",[t._v("重绘")]),t._v("。")]),t._v(" "),a("h4",{attrs:{id:"何时会发生回流重绘？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#何时会发生回流重绘？","aria-hidden":"true"}},[t._v("#")]),t._v(" 何时会发生回流重绘？")]),t._v(" "),a("p",[t._v("回流 "),a("code",[t._v("Layout")]),t._v(" 阶段是计算节点的几何信息和位置，那么当"),a("strong",[t._v("页面布局")]),t._v("或者"),a("strong",[t._v("几何信息")]),t._v("发生改变时，就会发生回流。")]),t._v(" "),a("ol",[a("li",[t._v("添加或者删除可见的 "),a("code",[t._v("DOM")]),t._v(" 元素。")]),t._v(" "),a("li",[t._v("元素的尺寸或者位置发生变化时。")]),t._v(" "),a("li",[t._v("页面开始渲染的时候。")]),t._v(" "),a("li",[t._v("浏览器的视口尺寸大小发生改变时（因为回流是根据浏览器视口的大小来计算元素的位置和尺寸大小）。")])]),t._v(" "),a("p",[a("strong",[t._v("注意：回流一定会触发重绘，而重绘不一定会触发回流（非几何信息的样式发生改变）, "),a("code",[t._v("reflow")]),t._v(" 回流的成本开销要高于 "),a("code",[t._v("repaint")]),t._v(" 重绘，一个节点的回流往往回导致子节点以及同级节点的回流。")])]),t._v(" "),a("p",[t._v("根据改变的范围和程度，渲染树中或大或小的部分需要重新计算，有些改变会触发整个页面的重排，比如，滚动条出现的时候或者修改了根节点。")]),t._v(" "),a("h4",{attrs:{id:"基于回流（layout）、重绘（painting）的优化方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于回流（layout）、重绘（painting）的优化方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 基于回流（Layout）、重绘（Painting）的优化方法")]),t._v(" "),a("h5",{attrs:{id:"_1-避免扰乱现代浏览器的优化机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-避免扰乱现代浏览器的优化机制","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 避免扰乱现代浏览器的优化机制")]),t._v(" "),a("p",[t._v("在现代浏览器的中，由于每次回流、重绘的时候，都需要额外的计算消耗，因此会通过队列化修改，并批量执行来优化这一过程。\n浏览器会将修改操作放入队列里面，直到过了一段时间或者达到一个阈值，才清空队列。")]),t._v(" "),a("p",[t._v("但是当你获取布局信息时，会强制刷新队列，例如：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("offsetTop、offsetLeft、offsetWidth、offsetHeight\n\nscrollTop、scrollLeft、scrollWidth、scrollHeight\n\nclientTop、clientLeft、clientWidth、clientHeight\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getComputedStyle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBoundingClientRect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("上面这些方法，都需要获取最新的布局信息，所以浏览器会强制刷新队列并执行回流、重绘，来获取最新的信息。\n因此我们在修改样式的时候，应该尽量避免使用上面的属性、方法，如果非要使用，可以先缓存起来然后一起获取。")]),t._v(" "),a("h5",{attrs:{id:"_2-css-的修改方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-css-的修改方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. "),a("code",[t._v("CSS")]),t._v(" 的修改方式")]),t._v(" "),a("p",[t._v("考虑以下代码：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'el'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("padding "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),t._v("\nel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("margin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),t._v("\nel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("border "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("这里元素的几何信息有三次被修改了，但是现代浏览器会将起缓存起来，但是如果这期间有通过前面列出来的属性、方法访问位置信息的话就会触发三次回流、重绘。所以还是建议通过 "),a("code",[t._v("cssText")]),t._v(" 或者 "),a("code",[t._v("class")]),t._v(" 的方法一次性修改。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cssText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'border-left: 1px; border-right: 2px; padding: 5px;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者")]),t._v("\nel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("className "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h5",{attrs:{id:"_3-批量修改-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-批量修改-dom","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 批量修改 DOM")]),t._v(" "),a("p",[t._v("当我们需要对 "),a("code",[t._v("DOM")]),t._v(" 进行一系列修改的时候，可以通过以下几种方式减少回流重绘次数：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("隐藏元素，应用修改，重新显示：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("appendToElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" li"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    li "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    li"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    appendToElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("li"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 首先脱离文档流")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'block'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 操作完以后再可见")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("使用文档片段("),a("code",[t._v("document fragment")]),t._v(")在当前 "),a("code",[t._v("DOM")]),t._v(" 之外构建一个子树，再把它拷贝回文档。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createDocumentFragment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])])]),t._v(" "),a("h5",{attrs:{id:"_4-独立图层"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-独立图层","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 独立图层")]),t._v(" "),a("p",[t._v("一个图层的回流和重绘只会在该图层当中进行，不会影响其他图层，所以有必要的时候，可以将某些元素放到单独的图层。")]),t._v(" "),a("p",[t._v("例如对于复杂动画效果，由于会经常的引起回流重绘，因此，我们可以使用绝对定位，让它脱离文档流， 成为一个单独的图层。否则会引起父元素以及后续元素频繁的回流。但是因该尽量少量使用图层，因为图层的合成是特别消耗性能，一个页面当中不能有过多的图层, 在使用了图层之后需要进行前后对比。")]),t._v(" "),a("p",[t._v("会自动建立图层的情况:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("3d")]),t._v(" 或者透视变换、过渡 "),a("code",[t._v("css")]),t._v(" 属性。")]),t._v(" "),a("li",[t._v("使用 "),a("code",[t._v("<video>")]),t._v(" 节点。")]),t._v(" "),a("li",[a("code",[t._v("<canvas>")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("flash")]),t._v("。")]),t._v(" "),a("li",[t._v("多透明度做 "),a("code",[t._v("css")]),t._v(" 动画。")])]),t._v(" "),a("h5",{attrs:{id:"_5-其他优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-其他优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 其他优化")]),t._v(" "),a("ul",[a("li",[t._v("用 "),a("code",[t._v("translate")]),t._v(" 替代 "),a("code",[t._v("top")]),t._v(" 改变："),a("code",[t._v("top")]),t._v(" 会触发回流，而前者不会。")]),t._v(" "),a("li",[t._v("用 "),a("code",[t._v("opacity")]),t._v(" 替代 "),a("code",[t._v("visibility")]),t._v("： 前者回流重绘都不会触发(前提是它单独在一个图层)，后者两个都会触发。")]),t._v(" "),a("li",[t._v("不要使用 "),a("code",[t._v("table")]),t._v(" 布局，"),a("code",[t._v("table")]),t._v(" 可能很小的一个改动会造成回流，很影响性能，应该尽量使用 "),a("code",[t._v("div")]),t._v("。")]),t._v(" "),a("li",[t._v("动画实现的速度选择。")]),t._v(" "),a("li",[t._v("对于动画新建图层。")]),t._v(" "),a("li",[t._v("启用 GPU 硬件加速: 使用 "),a("code",[t._v("transform:translateZ(0)")]),t._v("、"),a("code",[t._v("transform:translate3d(0,0,0)")]),t._v(" 来开启 GPU 硬件加速。")])]),t._v(" "),a("h3",{attrs:{id:"css-和-js-是这样阻塞-dom-解析和渲染的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-和-js-是这样阻塞-dom-解析和渲染的","aria-hidden":"true"}},[t._v("#")]),t._v(" CSS 和 JS 是这样阻塞 DOM 解析和渲染的")]),t._v(" "),a("p",[t._v("通过 "),a("code",[t._v("<script>")]),t._v(" 与 "),a("code",[t._v("<link>")]),t._v(" 引入外部资源，当解析到该标签的时候，会进行下载。")]),t._v(" "),a("ol",[a("li",[t._v("CSS 脚本的加载不会阻塞 "),a("code",[t._v("DOM")]),t._v(" 解析过程，但是会阻塞渲染过程("),a("code",[t._v("painting")]),t._v(")。")]),t._v(" "),a("li",[t._v("JS 脚本的加载与执行会阻塞 "),a("code",[t._v("DOM")]),t._v(" 解析过程, 但是不会阻塞后续资源的加载。")]),t._v(" "),a("li",[t._v("JS 脚本的加载中，如果你确定没必要阻塞 "),a("code",[t._v("DOM")]),t._v(" 解析的话，不妨按需要加上 "),a("code",[t._v("defer")]),t._v(" 或者 "),a("code",[t._v("async")]),t._v(" 属性，此时脚本下载的过程中是不会阻塞 "),a("code",[t._v("DOM")]),t._v(" 解析的。")]),t._v(" "),a("li",[t._v("浏览器遇到 "),a("code",[t._v("<script>")]),t._v(" 且没有 "),a("code",[t._v("defer")]),t._v(" 或 "),a("code",[t._v("async")]),t._v(" 属性的标签时，为了为 "),a("code",[t._v("<script>")]),t._v(" 标签内部的 js 提供最新的信息，会触发页面的回流、重绘过程。")]),t._v(" "),a("li",[t._v("如果前面 CSS 资源尚未加载完毕时，浏览器会等待它加载完毕之后再执行脚本。即 css 不阻塞 js 的加载，但阻塞它的执行。")])]),t._v(" "),a("p",[t._v("所以 "),a("code",[t._v("<script>")]),t._v(" 最好放底部(防止阻塞 "),a("code",[t._v("DOM")]),t._v(" 解析)。\n"),a("code",[t._v("<link>")]),t._v(" 最好放头部(为渲染过程提供样式)。如果头部同时有 "),a("code",[t._v("<script>")]),t._v(" 与 "),a("code",[t._v("<link>")]),t._v(" 的情况下，最好将 "),a("code",[t._v("<script>")]),t._v(" 放在 "),a("code",[t._v("<link>")]),t._v(" 上面(为了防止 CSS 脚本加载时间过长，使 js 等待时间也很长)。")]),t._v(" "),a("h3",{attrs:{id:"defer-和-async"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#defer-和-async","aria-hidden":"true"}},[t._v("#")]),t._v(" defer 和 async")]),t._v(" "),a("p",[t._v("绿色的代表 "),a("code",[t._v("html")]),t._v(" 解析，蓝色的代表 "),a("code",[t._v("javascript")]),t._v(" 脚本的下载，红色的代表 "),a("code",[t._v("javaScript")]),t._v(" 脚本的执行。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://qiniu.mdnice.com/d5471718236806507193c95751fba3a9.png",alt:"defer&async"}})]),t._v(" "),a("h2",{attrs:{id:"_9-浏览器的垃圾回收机制，如何避免内存泄漏。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-浏览器的垃圾回收机制，如何避免内存泄漏。","aria-hidden":"true"}},[t._v("#")]),t._v(" 9. 浏览器的垃圾回收机制，如何避免内存泄漏。")]),t._v(" "),a("p",[t._v("JavaScript 使用垃圾回收机制来自动管理内存。")]),t._v(" "),a("p",[t._v("JavaScript 的回收机制分两种：1.标记清除； 2.引用计数。（各大浏览器常用的是前）。")]),t._v(" "),a("h3",{attrs:{id:"引用计数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引用计数","aria-hidden":"true"}},[t._v("#")]),t._v(" 引用计数")]),t._v(" "),a("p",[t._v("跟踪记录每个值被引用的次数。")]),t._v(" "),a("ul",[a("li",[t._v("当声明一个变量并将引用类型的值赋给该变量时，则这个值的引用次数就是 "),a("code",[t._v("1")]),t._v("。")]),t._v(" "),a("li",[t._v("如果同一个值又被赋给另一个变量，则该值的引用次 数加 "),a("code",[t._v("1")]),t._v("。")]),t._v(" "),a("li",[t._v("相反，如果包含对这个值引用的变量又取得另外一个值，则这个值的引用次数减 "),a("code",[t._v("1")]),t._v("。")]),t._v(" "),a("li",[t._v("当这个值的引用次数变成 "),a("code",[t._v("0")]),t._v(" 时，则说明没有办法访问这个值了，因此就可以将其占用的内存空间回收回来。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     对象 a 的引用计数为 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("          对象 a 的引用计数为 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" \na "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       对象 a 的引用计数为 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" 不能被回收。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"标记清除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标记清除","aria-hidden":"true"}},[t._v("#")]),t._v(" 标记清除")]),t._v(" "),a("p",[t._v("标记清除的算法分为两个阶段：")]),t._v(" "),a("ul",[a("li",[t._v("标记（mark）：从引用根节点开始标记所有被引用的对象。")]),t._v(" "),a("li",[t._v("清除（sweep）：遍历整个堆，把未标记的对象进行清除。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("markFromRoots")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    worklist "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" empty\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" each fld "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" Roots\n        ref "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("fld\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ref "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNotMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n           "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("worklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" not "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("worklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          ref "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("worklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" each fld "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Pointers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n                child "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("fld\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" child "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNotMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("worklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sweep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    scan "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" start\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" scan "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" end\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setUnMarked")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      scan "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\natomic "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("collect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("markFromRoots")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sweep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HeapStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("HeapEnd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br")])]),a("h3",{attrs:{id:"开发过程中遇到的内存泄露情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发过程中遇到的内存泄露情况","aria-hidden":"true"}},[t._v("#")]),t._v(" 开发过程中遇到的内存泄露情况")]),t._v(" "),a("h4",{attrs:{id:"_1-定义和用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-定义和用法","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 定义和用法")]),t._v(" "),a("p",[t._v("内存泄露是指一块被分配的内存既不能使用，又不能回收，直到浏览器进程结束。")]),t._v(" "),a("p",[a("em",[a("code",[t._v("C#")]),t._v(" 和 "),a("code",[t._v("Java")]),t._v(" 等语言采用了自动垃圾回收方法管理内存，几乎不会发生内存泄露。")])]),t._v(" "),a("p",[t._v("我们知道，浏览器中也是采用自动垃圾回收方法管理内存，但由于浏览器垃圾回收方法有 "),a("code",[t._v("bug")]),t._v("，会产生内存泄露。")]),t._v(" "),a("p",[t._v("由于每次的垃圾回收开销都相对较大，并且由于机制的一些不完善的地方，可能会导致内存泄露。我们可以利用一些方法减少垃圾回收，并且"),a("strong",[t._v("尽量避免循环引用")]),t._v("的问题。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("例如，在对象结束使用后，令 "),a("code",[t._v("obj = null")]),t._v("（这样利于解除循环引用，使得无用变量及时被回收）。")])]),t._v(" "),a("li",[a("p",[t._v("再如，JS 中开辟空间的操作有 "),a("code",[t._v("new()")]),t._v("、"),a("code",[t._v("[]")]),t._v("、"),a("code",[t._v("{}")]),t._v("、"),a("code",[t._v("function (){..}")]),t._v("，在创建新对象的时候要尽量考虑增大对象的"),a("strong",[t._v("复用性")]),t._v("。")])])]),t._v(" "),a("h4",{attrs:{id:"_2-内存泄漏的几种情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-内存泄漏的几种情况","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 内存泄漏的几种情况")]),t._v(" "),a("p",[t._v("虽然有垃圾回收机制，但是，我们编写代码操作不当还是会造成内存泄漏。")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("意外的全局变量引起的内存泄漏。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("原因：全局变量，不会被回收。\n解决：使用严格模式避免。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("闭包引起的内存泄漏。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("原因：闭包可以维持函数内局部变量，使其得不到释放。\n解决：将事件处理函数定义在外部，解除闭包，或者在定义事件处理函数的外部函数中，删除对 dom 的引用。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("没有清理的 "),a("code",[t._v("DOM")]),t._v(" 元素引用。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("原因：虽然别的地方删除了，但是对象中还存在对 dom 的引用。\n解决：手动删除。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("被遗忘的定时器或者回调。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("原因：定时器中有 dom 的引用，即使 dom 删除了，但是定时器还在，所以内存中还是有这个 dom。\n解决：手动删除定时器和 dom。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("子元素存在引用引起的内存泄漏。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("原因：造成父元素间接引用子元素，即使子元素被清空，也还是在内存中。\n解决：手动删除清空。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])])]),t._v(" "),a("p",[t._v("2、内存泄露的几种情况:")]),t._v(" "),a("p",[t._v("虽然有垃圾回收机制，但是，我们编写代码操作不当还是会造成内存泄漏。")]),t._v(" "),a("ol",[a("li",[t._v("意外的全局变量引起的内存泄漏。")])]),t._v(" "),a("p",[t._v("原因：全局变量，不会被回收。")]),t._v(" "),a("p",[t._v("解决：使用严格模式避免。")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("闭包引起的内存泄漏")])]),t._v(" "),a("p",[t._v("原因：闭包可以维持函数内局部变量，使其得不到释放。")]),t._v(" "),a("p",[t._v("解决：将事件处理函数定义在外部，解除闭包,或者在定义事件处理函数的外部函数中，删除对dom的引用。")]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("没有清理的DOM元素引用")])]),t._v(" "),a("p",[t._v("原因：虽然别的地方删除了，但是对象中还存在对dom的引用")]),t._v(" "),a("p",[t._v("解决：手动删除。")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("被遗忘的定时器或者回调")])]),t._v(" "),a("p",[t._v("原因：定时器中有dom的引用，即使dom删除了，但是定时器还在，所以内存中还是有这个dom。")]),t._v(" "),a("p",[t._v("解决：手动删除定时器和dom。")]),t._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[t._v("子元素存在引用引起的内存泄漏")])]),t._v(" "),a("p",[t._v("原因：div中的ul li  得到这个div，会间接引用某个得到的li，那么此时因为div间接引用li，即使li被清空，也还是在内存中，并且只要li不被删除，他的父元素都不会被删除。")]),t._v(" "),a("p",[t._v("解决：手动删除清空。")]),t._v(" "),a("h2",{attrs:{id:"_10-浏览器采用的缓存方案，如何选择和控制合适的缓存方案。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-浏览器采用的缓存方案，如何选择和控制合适的缓存方案。","aria-hidden":"true"}},[t._v("#")]),t._v(" 10. 浏览器采用的缓存方案，如何选择和控制合适的缓存方案。")])])}),[],!1,null,null,null);s.default=e.exports}}]);