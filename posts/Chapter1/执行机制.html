<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
    <title>执行机制 | 面试API</title>
    <meta name="description" content="前端面试API，自检清单，公众号推荐" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="执行机制 | 面试API" />
    <meta property="og:site_name" content="执行机制 | 面试API" />
    <meta property="og:locale" content="zh-CN" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="执行机制 | 面试API" />
    <link rel="shortut icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.7b9b750d.css" as="style"><link rel="preload" href="/assets/js/app.fc91762f.js" as="script"><link rel="preload" href="/assets/js/1.f64d0f29.js" as="script"><link rel="preload" href="/assets/js/6.398f3111.js" as="script"><link rel="preload" href="/assets/js/5.f545b33f.js" as="script"><link rel="preload" href="/assets/js/8.3b6e6663.js" as="script"><link rel="preload" href="/assets/js/11.c17f5374.js" as="script"><link rel="preload" href="/assets/js/7.90c337c1.js" as="script"><link rel="preload" href="/assets/js/28.1abfa8f7.js" as="script"><link rel="preload" href="/assets/js/16.771fd771.js" as="script"><link rel="prefetch" href="/assets/js/10.d736433b.js"><link rel="prefetch" href="/assets/js/12.276062e2.js"><link rel="prefetch" href="/assets/js/13.fef2af1e.js"><link rel="prefetch" href="/assets/js/14.7801038d.js"><link rel="prefetch" href="/assets/js/15.1806bfa9.js"><link rel="prefetch" href="/assets/js/17.93995b1d.js"><link rel="prefetch" href="/assets/js/18.9f1322f4.js"><link rel="prefetch" href="/assets/js/19.8de32ff1.js"><link rel="prefetch" href="/assets/js/20.0ac526d6.js"><link rel="prefetch" href="/assets/js/21.43d74702.js"><link rel="prefetch" href="/assets/js/22.512ab14f.js"><link rel="prefetch" href="/assets/js/23.7db4a8c3.js"><link rel="prefetch" href="/assets/js/24.bb8be84b.js"><link rel="prefetch" href="/assets/js/25.223d3833.js"><link rel="prefetch" href="/assets/js/26.8893ec62.js"><link rel="prefetch" href="/assets/js/27.8ba9faa8.js"><link rel="prefetch" href="/assets/js/29.0f83c879.js"><link rel="prefetch" href="/assets/js/30.ab09733f.js"><link rel="prefetch" href="/assets/js/31.a2bb5afc.js"><link rel="prefetch" href="/assets/js/32.3f6c49d7.js"><link rel="prefetch" href="/assets/js/33.0e76e331.js"><link rel="prefetch" href="/assets/js/34.8425f82b.js"><link rel="prefetch" href="/assets/js/35.663faf23.js"><link rel="prefetch" href="/assets/js/36.758c68c9.js"><link rel="prefetch" href="/assets/js/37.ef49f88a.js"><link rel="prefetch" href="/assets/js/38.60f185fc.js"><link rel="prefetch" href="/assets/js/39.f2843425.js"><link rel="prefetch" href="/assets/js/4.2b5d276e.js"><link rel="prefetch" href="/assets/js/40.f16546ac.js"><link rel="prefetch" href="/assets/js/41.b839aa8f.js"><link rel="prefetch" href="/assets/js/42.fe725d61.js"><link rel="prefetch" href="/assets/js/43.039c8adc.js"><link rel="prefetch" href="/assets/js/44.01e4ea13.js"><link rel="prefetch" href="/assets/js/45.7e9ae2c1.js"><link rel="prefetch" href="/assets/js/46.fe94e5f4.js"><link rel="prefetch" href="/assets/js/47.1ba303ce.js"><link rel="prefetch" href="/assets/js/48.b71e564e.js"><link rel="prefetch" href="/assets/js/49.a879ca2a.js"><link rel="prefetch" href="/assets/js/50.9a8d27cf.js"><link rel="prefetch" href="/assets/js/51.b85671e5.js"><link rel="prefetch" href="/assets/js/52.26d48285.js"><link rel="prefetch" href="/assets/js/53.8904b382.js"><link rel="prefetch" href="/assets/js/54.aa61a66e.js"><link rel="prefetch" href="/assets/js/55.2d89720a.js"><link rel="prefetch" href="/assets/js/56.2f6ab608.js"><link rel="prefetch" href="/assets/js/57.289ff669.js"><link rel="prefetch" href="/assets/js/58.bf9ea710.js"><link rel="prefetch" href="/assets/js/9.0c627255.js"><link rel="prefetch" href="/assets/js/search.a2e0f584.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b9b750d.css">
  </head>
  <body>
    <div id="loader-wrapper" style="display: none;opacity:0">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
    </div>
    <div id="app" data-server-rendered="true"><div data-v-8ae45032><section class="el-container" data-v-8ae45032><aside width="200px" class="el-aside menu" style="width:auto;" data-v-28ba16cc data-v-8ae45032><div class="brand-wrap" style="background-image:url(/aside.jpg);" data-v-28ba16cc><div class="brand" data-v-28ba16cc><a href="/" class="avatar waves-effect waves-circle waves-light router-link-active" data-v-28ba16cc><img src="/infoq1.png" data-v-28ba16cc></a> <hgroup class="introduce" data-v-28ba16cc><div class="nickname" data-v-28ba16cc><img src="/name.png" data-v-28ba16cc></div> <div data-v-28ba16cc><a title="253929992@qq.com" class="mail" data-v-28ba16cc>253929992@qq.com</a></div></hgroup></div></div> <ul role="menubar" class="menu-wrap el-menu" style="background-color:;" data-v-28ba16cc><li role="menuitem" aria-haspopup="true" aria-expanded="true" class="el-submenu is-opened" data-v-28ba16cc><div class="el-submenu__title" style="padding-left:20px;color:;background-color:;"><i class="iconfont icon-icon37" data-v-28ba16cc></i> <span slot="title" class="item-title" data-v-28ba16cc>自检清单</span><i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><ul role="menu" class="el-menu el-menu--inline" style="background-color:;"> <li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            JS基础
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            HTML&amp;CSS
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            计算机基础
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            数据结构和算法
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            运行环境
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            框架
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            工程化
          </span></li></ul></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-28ba16cc><i class="iconfont icon-shijianzhou" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
        时间轴
      </span></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-28ba16cc><i class="iconfont icon-guanyu" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
        个人档案
      </span></li></ul></aside> <section class="el-container container-warp" data-v-8ae45032><header id="topHeader" class="el-header top-header" style="height:60px;padding-left:300px;" data-v-19b46bf8 data-v-8ae45032><div class="header-warp el-row is-align-center el-row--flex" data-v-19b46bf8><div class="el-col el-col-2 el-col-xs-7" data-v-19b46bf8><button type="button" class="el-button header-btn el-button--primary el-button--mini is-circle" data-v-19b46bf8><!----><!----><span><i class="iconfont icon-rightjustified" data-v-19b46bf8></i></span></button></div> <div class="el-col el-col-10 el-col-xs-24" data-v-19b46bf8><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-2245" class="el-autocomplete search-input" data-v-19b46bf8><div class="el-input el-input--small el-input--suffix"><!----><input type="text" autocomplete="off" valueKey="value" popperClass="search-popper" placeholder="搜搜看" fetchSuggestions="function () { [native code] }" debounce="300" placement="bottom-start" popperAppendToBody="true" value="" class="el-input__inner"><!----><span class="el-input__suffix"><span class="el-input__suffix-inner"><i class="el-input__icon el-icon-search search-ico" data-v-19b46bf8></i><!----></span><!----></span><!----></div><div role="region" class="el-autocomplete-suggestion el-popper search-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div> <div class="nav-col el-col el-col-8 el-col-offset-10 el-col-xs-24" data-v-19b46bf8><ul role="menubar" class="header-menu el-menu--horizontal el-menu" style="background-color:transparent;" data-v-19b46bf8><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:#fdf5ab;border-bottom-color:transparent;background-color:transparent;" data-v-19b46bf8>Home</li><li role="menuitem" tabindex="-1" class="el-menu-item is-active" style="color:#ffd04b;border-bottom-color:#ffd04b;background-color:transparent;" data-v-19b46bf8>Blog</li></ul></div></div></header> <main class="el-main my-main" style="margin-left:238px;" data-v-2c373c2f data-v-8ae45032><div class="content-header index-header" style="background-image:url(/banner.jpg);" data-v-2102b4f3 data-v-2c373c2f><div class="container" data-v-2102b4f3><h1 id="conentHeader" class="title animated fadeInDown" data-v-2102b4f3>执行机制</h1> <h5 class="subtitle" data-v-2102b4f3>最后更新时间：2019-10-21 11:26:01</h5> <div class="el-row is-align-center el-row--flex" data-v-2c373c2f><div class="tag-card el-col el-col-20 el-col-xs-23 el-col-sm-22 el-col-md-22 el-col-lg-20" data-v-2c373c2f><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>实现轮子</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>Vue组件通信</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>CSS</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>实用库</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>多端开发</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>网络协议</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>Nginx</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>编译原理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>数据流管理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>算法</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>开发提速</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>编码能力</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>持续集成</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>TypeScript</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>React</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>Angular</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>项目构建</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>HTML</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>版本控制</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>设计模式</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>手写</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>浏览器API</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>数据结构</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>开发和测试</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>Vue</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>浏览器原理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>Node</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>变量和类型</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>执行机制</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>作用域和闭包</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>语法和API</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-2c373c2f>原型和原型链</span></div></div></div></div> <div data-v-3a701865 data-v-2c373c2f><div class="post-content el-row is-justify-center el-row--flex" data-v-3a701865><div id="post-card" class="post-card post-sign el-col el-col-16 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-3a701865><div class="content__default" data-v-3a701865><h2 id="_1-为何-try-里面放-return，finally-还会执行，理解其内部机制。"><a href="#_1-为何-try-里面放-return，finally-还会执行，理解其内部机制。" aria-hidden="true" class="header-anchor">#</a> 1. 为何 try 里面放 return，finally 还会执行，理解其内部机制。</h2> <p>如果存在 <code>finally</code> 代码块，<code>try</code> 中的 <code>return</code> 语句不会立马返回给调用者，
而是记录下返回值等待 <code>finally</code> 代码块执行完毕之后再返回。</p> <p><strong>注意的几点：</strong></p> <ul><li><p>不管 <code>try</code> 里有没有返回值，<code>finally</code> 都会执行。</p></li> <li><p>不管有没有异常，<code>finally</code> 都会被执行。</p></li> <li><p><code>finally</code> 里边的返回值会覆盖 <code>try</code> 中返回的值。</p></li></ul> <h2 id="_2-javascript-如何实现异步编程，可以详细描述-eventloop-机制。"><a href="#_2-javascript-如何实现异步编程，可以详细描述-eventloop-机制。" aria-hidden="true" class="header-anchor">#</a> 2. JavaScript 如何实现异步编程，可以详细描述 EventLoop 机制。</h2> <h2 id="_3-宏任务和微任务分别有哪些"><a href="#_3-宏任务和微任务分别有哪些" aria-hidden="true" class="header-anchor">#</a> 3. 宏任务和微任务分别有哪些?</h2> <p>**宏任务：**事件队列中每一个事件、<code>setImmediate（node环境）</code>、 <code>MessageChannel</code>、 <code>setTimeout</code>、<code>setInterval</code>。
<strong>微任务：</strong><code>Promise.then()</code> 、<code>MutationObserver</code>、<code>process.nextTick（node环境）</code>。</p> <h2 id="_4-可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法。"><a href="#_4-可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法。" aria-hidden="true" class="header-anchor">#</a> 4. 可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法。</h2> <h2 id="_5-使用promise实现串行。-不对"><a href="#_5-使用promise实现串行。-不对" aria-hidden="true" class="header-anchor">#</a> 5. 使用<code>Promise</code>实现串行。 不对</h2> <p><strong>Promise 串行的实现原理：</strong> 让每个串行中的任务都返回一个 <code>Promise</code>，最后统一由 <code>Promise</code> 进行 <code>then</code> 链式调用达到串行的目的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">third</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;promise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">task</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">task</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">task</span><span class="token punctuation">(</span>third<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1</span>
<span class="token comment">// 2</span>
<span class="token comment">// 3</span>
<span class="token comment">// promise</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_6-node-与浏览器-eventloop-的差异。"><a href="#_6-node-与浏览器-eventloop-的差异。" aria-hidden="true" class="header-anchor">#</a> 6. Node 与浏览器 EventLoop 的差异。</h2> <h3 id="事件循环"><a href="#事件循环" aria-hidden="true" class="header-anchor">#</a> 事件循环</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code>事件循环是计算机系统的一种运行机制，JavaScript 采用事件循环机制来处理异步任务的执行。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" target="_blank" rel="noopener noreferrer">HTML规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中指出：一个事件循环有一个或者多个<strong>任务队列（Task Queue）</strong>，一个任务队列有一组<strong>任务（异步任务）</strong>。</p> <p>任务可以分成两种，一种是<strong>同步任务</strong>，另一种是<strong>异步任务</strong>。</p> <p><strong>同步任务</strong>是指在主线程上排队执行的任务，同步任务形成 <code>执行栈</code>。</p> <p><strong>异步任务</strong>不进入主线程排队，而是进入 <code>Task Queue</code> 排队的任务，只有 <code>Task Queue</code> 通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>执行栈中的同步任务执行完毕后，才会将 Task Queue 中的异步任务加入到主线程执行。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>异步任务分为：<strong>宏任务（macrotask）<strong>和</strong>微任务（microtask）</strong>。</p> <ul><li><p><strong>宏任务（macrotask）：</strong>
包含执行整体的 JavaScript 代码、事件回调、XHR 回调、定时器（setTimeout/setInterval/setImmediate）、IO操作以及UI渲染。</p></li> <li><p><strong>微任务（microtask）：</strong>
更新应用程序状态的任务，包括 <code>promise</code> 回调、<code>MutationObserver</code>、<code>process.nextTick</code> 以及 <code>Object.observe</code>。</p></li></ul> <img alt="event-loop" src="https://i.loli.net/2019/09/27/wNb9KecBHvyGtWL.png" width="80%"> <h3 id="node-js-中的事件循环"><a href="#node-js-中的事件循环" aria-hidden="true" class="header-anchor">#</a> Node.js 中的事件循环</h3> <p>当 <code>node.js</code> 运行时，会初始化一个 <code>EventLoop</code>，处理那些通过<strong>异步api调用</strong>、<strong>定时器</strong>或者调用 <code>process.nextTick()</code> 提供的 <code>script</code>或者输入到 <code>REPL</code> 中的 <code>script</code>。</p> <p>下图展示了事件循环的操作顺序以及概要。</p> <img alt="node事件循环" src="https://i.loli.net/2019/09/27/jZNezAMIwUkbxWR.png" width="90%"> <h3 id="浏览器中的事件循环"><a href="#浏览器中的事件循环" aria-hidden="true" class="header-anchor">#</a> 浏览器中的事件循环</h3> <ul><li><p>执行一个<strong>宏任务（macrotask）</strong>。</p></li> <li><p>执行过程中如果遇到<strong>微任务（microtask）</strong>，就将它添加到微任务的任务队列中。</p></li> <li><p>**宏任务（macrotask）<strong>执行完毕后，立即执行当前</strong>微任务（microtask）**队列中的所有微任务（先进先出）。</p></li> <li><p>当前**宏任务（macrotask）**执行完毕，开始检查渲染，然后 <code>GUI</code> 线程接管渲染。</p></li></ul> <img alt="浏览器事件循环" src="https://i.loli.net/2019/09/27/vskWbIJrhP5CKX9.png" width="50%"> <h3 id="差异："><a href="#差异：" aria-hidden="true" class="header-anchor">#</a> 差异：</h3> <p><strong>Node.js 中</strong>，微任务 <code>microtask</code> 会在事件循环的各个阶段之间执行，也就是一个阶段执行完毕，就会去执行 <code>microtask</code> 队列的任务。</p> <img alt="node事件循环" src="https://i.loli.net/2019/09/27/THPNqOjWvIAXsBG.png" width="70%"> <p><strong>浏览器环境下</strong>，微任务 <code>microtask</code> 任务队列是每个宏任务 <code>macrotask</code> 执行完之后执行。</p> <img alt="浏览器事件循环" src="https://i.loli.net/2019/09/27/7rbNAxsjhLf3uZM.png" width="70%"> <h2 id="_7-如何在保证页面运行流畅的情况下处理海量数据。"><a href="#_7-如何在保证页面运行流畅的情况下处理海量数据。" aria-hidden="true" class="header-anchor">#</a> 7. 如何在保证页面运行流畅的情况下处理海量数据。</h2></div> <span id="footerPost" data-v-3a701865></span></div> <div id="post-toc" class="post-toc el-col el-col-6" data-v-3a701865><div class="catalog-body" data-v-3a701865><h4 class="catalog-title" data-v-3a701865>目录</h4> <ul id="catalog-list" class="catalog-list" data-v-3a701865></ul></div></div></div> <div class="el-row is-justify-center el-row--flex" data-v-3a701865><div class="post-card vssue-wrap el-col el-col-21 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-3a701865></div></div> <div class="post-nav el-row is-justify-space-around el-row--flex" data-v-3a701865><div class="post-prev el-col el-col-7" data-v-3a701865><div data-v-3a701865><a href="/posts/Chapter1/" class="router-link-active" data-v-3a701865><i class="el-icon-arrow-left" data-v-3a701865></i> Prev
        </a> <p class="nav-title router-link-active" data-v-3a701865>变量和类型</p></div></div> <div class="post-next el-col el-col-7 el-col-lg-pull-5" data-v-3a701865><div data-v-3a701865><a href="/posts/Chapter1/%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85.html" data-v-3a701865>
          Next
          <i class="el-icon-arrow-right" data-v-3a701865></i></a> <p class="nav-title" data-v-3a701865>作用域和闭包</p></div></div></div> <span data-v-d34d3092 data-v-3a701865><button type="button" class="el-button toc-btn el-button--primary is-circle" data-v-d34d3092><!----><!----><span><i class="iconfont icon-service-directory" data-v-d34d3092></i></span></button> <button type="button" class="el-button gotop-btn el-button--primary is-circle" data-v-d34d3092><!----><!----><span><i class="el-icon-arrow-up" data-v-d34d3092></i></span></button></span></div></main></section> <button type="button" class="el-button gotop-btn el-button--primary is-circle" style="display:none;" data-v-1918517c data-v-8ae45032><!----><!----><span><i class="el-icon-arrow-up" data-v-1918517c></i></span></button></section> <div class="overlay" data-v-8ae45032></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fc91762f.js" defer></script><script src="/assets/js/1.f64d0f29.js" defer></script><script src="/assets/js/6.398f3111.js" defer></script><script src="/assets/js/5.f545b33f.js" defer></script><script src="/assets/js/8.3b6e6663.js" defer></script><script src="/assets/js/11.c17f5374.js" defer></script><script src="/assets/js/7.90c337c1.js" defer></script><script src="/assets/js/28.1abfa8f7.js" defer></script><script src="/assets/js/16.771fd771.js" defer></script>
  </body>
</html>
