<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
    <title>执行上下文 | 面试API</title>
    <meta name="description" content="前端面试API，自检清单，公众号推荐" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="执行上下文 | 面试API" />
    <meta property="og:site_name" content="执行上下文 | 面试API" />
    <meta property="og:locale" content="zh-CN" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="执行上下文 | 面试API" />
    <link rel="shortut icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.5f1fa08a.css" as="style"><link rel="preload" href="/assets/js/app.e48c3d44.js" as="script"><link rel="preload" href="/assets/js/1.9aa2b147.js" as="script"><link rel="preload" href="/assets/js/6.ab6f709e.js" as="script"><link rel="preload" href="/assets/js/5.0f5d195d.js" as="script"><link rel="preload" href="/assets/js/8.b943e6ee.js" as="script"><link rel="preload" href="/assets/js/11.fb958432.js" as="script"><link rel="preload" href="/assets/js/7.a46ab4a3.js" as="script"><link rel="preload" href="/assets/js/34.5b4ce795.js" as="script"><link rel="preload" href="/assets/js/16.f738196f.js" as="script"><link rel="prefetch" href="/assets/js/10.175139c9.js"><link rel="prefetch" href="/assets/js/12.85f229b3.js"><link rel="prefetch" href="/assets/js/13.96b776c5.js"><link rel="prefetch" href="/assets/js/14.e8a31a31.js"><link rel="prefetch" href="/assets/js/15.79c8d111.js"><link rel="prefetch" href="/assets/js/17.c9beec15.js"><link rel="prefetch" href="/assets/js/18.311c5248.js"><link rel="prefetch" href="/assets/js/19.6a1d7086.js"><link rel="prefetch" href="/assets/js/20.3e55f9ce.js"><link rel="prefetch" href="/assets/js/21.8d277f89.js"><link rel="prefetch" href="/assets/js/22.d1bd9642.js"><link rel="prefetch" href="/assets/js/23.7db4a8c3.js"><link rel="prefetch" href="/assets/js/24.1cb17e4b.js"><link rel="prefetch" href="/assets/js/25.e05bfa14.js"><link rel="prefetch" href="/assets/js/26.66417429.js"><link rel="prefetch" href="/assets/js/27.e37ba2d1.js"><link rel="prefetch" href="/assets/js/28.9981806c.js"><link rel="prefetch" href="/assets/js/29.0afdd99a.js"><link rel="prefetch" href="/assets/js/30.d9df9218.js"><link rel="prefetch" href="/assets/js/31.9f122e57.js"><link rel="prefetch" href="/assets/js/32.3be6e805.js"><link rel="prefetch" href="/assets/js/33.bc58239e.js"><link rel="prefetch" href="/assets/js/35.d5108ab9.js"><link rel="prefetch" href="/assets/js/36.6b511d0c.js"><link rel="prefetch" href="/assets/js/37.94b94dfb.js"><link rel="prefetch" href="/assets/js/38.d1f5520c.js"><link rel="prefetch" href="/assets/js/39.f4548d5d.js"><link rel="prefetch" href="/assets/js/4.2b5d276e.js"><link rel="prefetch" href="/assets/js/40.81df4ece.js"><link rel="prefetch" href="/assets/js/41.5c15cc5a.js"><link rel="prefetch" href="/assets/js/42.94194640.js"><link rel="prefetch" href="/assets/js/43.f7be967b.js"><link rel="prefetch" href="/assets/js/44.b7364342.js"><link rel="prefetch" href="/assets/js/45.a5be72ef.js"><link rel="prefetch" href="/assets/js/46.5dd241ea.js"><link rel="prefetch" href="/assets/js/47.d59f707a.js"><link rel="prefetch" href="/assets/js/48.866defb6.js"><link rel="prefetch" href="/assets/js/49.98fdaefc.js"><link rel="prefetch" href="/assets/js/50.3e139586.js"><link rel="prefetch" href="/assets/js/51.3fcba8e1.js"><link rel="prefetch" href="/assets/js/52.651a2d94.js"><link rel="prefetch" href="/assets/js/53.892cbb93.js"><link rel="prefetch" href="/assets/js/54.32e1b9ce.js"><link rel="prefetch" href="/assets/js/55.2db2bfa6.js"><link rel="prefetch" href="/assets/js/56.1ac7678c.js"><link rel="prefetch" href="/assets/js/57.f744e726.js"><link rel="prefetch" href="/assets/js/58.0b48a602.js"><link rel="prefetch" href="/assets/js/59.6fd53a34.js"><link rel="prefetch" href="/assets/js/60.93edb351.js"><link rel="prefetch" href="/assets/js/61.1c5d6435.js"><link rel="prefetch" href="/assets/js/62.04e9e017.js"><link rel="prefetch" href="/assets/js/63.456f3577.js"><link rel="prefetch" href="/assets/js/64.a1c8d614.js"><link rel="prefetch" href="/assets/js/65.549a8c78.js"><link rel="prefetch" href="/assets/js/66.81658fbf.js"><link rel="prefetch" href="/assets/js/67.a7e6e80a.js"><link rel="prefetch" href="/assets/js/68.f119f6cf.js"><link rel="prefetch" href="/assets/js/69.79ea2aba.js"><link rel="prefetch" href="/assets/js/70.92112509.js"><link rel="prefetch" href="/assets/js/9.ba7c49dc.js"><link rel="prefetch" href="/assets/js/search.29d23745.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5f1fa08a.css">
  </head>
  <body>
    <div id="loader-wrapper" style="display: none;opacity:0">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
    </div>
    <div id="app" data-server-rendered="true"><div data-v-8ae45032><section class="el-container" data-v-8ae45032><aside width="200px" class="el-aside menu" style="width:auto;" data-v-28ba16cc data-v-8ae45032><div class="brand-wrap" style="background-image:url(/aside.jpg);" data-v-28ba16cc><div class="brand" data-v-28ba16cc><a href="/" class="avatar waves-effect waves-circle waves-light router-link-active" data-v-28ba16cc><img src="/infoq1.png" data-v-28ba16cc></a> <hgroup class="introduce" data-v-28ba16cc><div class="nickname" data-v-28ba16cc><img src="/name.png" data-v-28ba16cc></div> <div data-v-28ba16cc><a title="253929992@qq.com" class="mail" data-v-28ba16cc>253929992@qq.com</a></div></hgroup></div></div> <ul role="menubar" class="menu-wrap el-menu" style="background-color:;" data-v-28ba16cc><li role="menuitem" aria-haspopup="true" aria-expanded="true" class="el-submenu is-opened" data-v-28ba16cc><div class="el-submenu__title" style="padding-left:20px;color:;background-color:;"><i class="iconfont icon-icon37" data-v-28ba16cc></i> <span slot="title" class="item-title" data-v-28ba16cc>自检清单</span><i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><ul role="menu" class="el-menu el-menu--inline" style="background-color:;"> <li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            JS基础
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            HTML&amp;CSS
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            计算机基础
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            数据结构和算法
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            运行环境
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            框架
          </span></li><li role="menuitem" tabindex="-1" default-active="1" class="el-menu-item" style="padding-left:40px;color:;background-color:;" data-v-28ba16cc><i class="el-icon-news" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
            工程化
          </span></li></ul></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-28ba16cc><i class="iconfont icon-shijianzhou" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
        时间轴
      </span></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-28ba16cc><i class="iconfont icon-guanyu" data-v-28ba16cc></i> <span class="item-title" data-v-28ba16cc>
        个人档案
      </span></li></ul></aside> <section class="el-container container-warp" data-v-8ae45032><header id="topHeader" class="el-header top-header" style="height:60px;padding-left:300px;" data-v-7e316482 data-v-8ae45032><div class="header-warp el-row is-align-center el-row--flex" data-v-7e316482><div class="el-col el-col-2 el-col-xs-7" data-v-7e316482><button type="button" class="el-button header-btn el-button--primary el-button--mini is-circle" data-v-7e316482><!----><!----><span><i class="iconfont icon-rightjustified" data-v-7e316482></i></span></button></div> <div class="el-col el-col-10 el-col-xs-24" data-v-7e316482><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-7362" class="el-autocomplete search-input" data-v-7e316482><div class="el-input el-input--small el-input--suffix"><!----><input type="text" autocomplete="off" valueKey="value" popperClass="search-popper" placeholder="搜搜看" fetchSuggestions="function () { [native code] }" debounce="300" placement="bottom-start" popperAppendToBody="true" value="" class="el-input__inner"><!----><span class="el-input__suffix"><span class="el-input__suffix-inner"><i class="el-input__icon el-icon-search search-ico" data-v-7e316482></i><!----></span><!----></span><!----></div><div role="region" class="el-autocomplete-suggestion el-popper search-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div> <div class="nav-col el-col el-col-8 el-col-offset-10 el-col-xs-24" data-v-7e316482><ul role="menubar" class="header-menu el-menu--horizontal el-menu" style="background-color:transparent;" data-v-7e316482><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:#fdf5ab;border-bottom-color:transparent;background-color:transparent;" data-v-7e316482>Home</li><li role="menuitem" tabindex="-1" class="el-menu-item is-active" style="color:#ffd04b;border-bottom-color:#ffd04b;background-color:transparent;" data-v-7e316482>Blog</li></ul></div></div></header> <main class="el-main my-main" style="margin-left:238px;" data-v-47f536a8 data-v-8ae45032><div class="content-header index-header" style="background-image:url(/banner.jpg);" data-v-1ba67baf data-v-47f536a8><div class="container" data-v-1ba67baf><h1 id="conentHeader" class="title animated fadeInDown" data-v-1ba67baf>执行上下文</h1> <h5 class="subtitle" data-v-1ba67baf>最后更新时间：2019-11-21 16:13:47</h5> <div class="el-row is-align-center el-row--flex" data-v-47f536a8><div class="tag-card el-col el-col-20 el-col-xs-23 el-col-sm-22 el-col-md-22 el-col-lg-20" data-v-47f536a8><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>Vue</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>AST抽象语法树</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>网络协议</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>工具函数</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>vue生命周期</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>性能优化</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>闭包</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>编译原理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>CSS渲染原理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>回流与重绘</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>判断数据类型</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>this</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>执行上下文</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>高阶函数</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>浏览器缓存</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>HTML汇总</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>BFC</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>Vue组件通信</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>CSS盒模型</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>CSS伪类</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>CSS</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>垂直居中</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>CSS选择器</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>三栏布局</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>实现轮子</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>数据结构</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>算法</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>TypeScript</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>项目构建</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>版本控制</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>持续集成</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>开发提速</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>数据流管理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>Nginx</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>编码能力</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>React</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>异常处理</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>基础问题</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>作用域</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>执行机制</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>正则表达式</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>类型转换</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>Symbol</span><span class="animated fadeInRight el-tag el-tag--medium is-hit" data-v-47f536a8>原型和原型链</span></div></div></div></div> <div data-v-3a18dd0a data-v-47f536a8 data-v-47f536a8><div class="post-content el-row is-justify-center el-row--flex" data-v-3a18dd0a><div id="post-card" class="post-card post-sign el-col el-col-16 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-3a18dd0a><div class="content__default" data-v-3a18dd0a><h2 id="_1-理解-javascript-的执行上下文。"><a href="#_1-理解-javascript-的执行上下文。" aria-hidden="true" class="header-anchor">#</a> 1. 理解 JavaScript 的执行上下文。</h2> <h4 id="什么是执行上下文？"><a href="#什么是执行上下文？" aria-hidden="true" class="header-anchor">#</a> 什么是执行上下文？</h4> <p>当函数执行时，会创建一个称为执行上下文的变量对象<code>可理解为作用域</code>。一个执行上下文定义了一个函数执行时的环境。</p> <p><code>执行上下文</code>也分为两种类型：</p> <ul><li><p><strong>全局执行上下文：</strong> 代码首次执行时候的默认环境，在代码的整个执行过程中，只用一个全局执行上下文。</p></li> <li><p><strong>函数执行上下文：</strong> 每当执行流程进入到一个函数体内部的时候，就会创建一个函数执行上下文，<code>可以有任意数量的函数执行上下文</code>。</p></li></ul> <p><strong>执行上下文主要有两个阶段：</strong> <code>创建阶段</code>和<code>执行阶段</code>。</p> <p><strong>创建阶段：</strong></p> <ul><li><p>首先，为每个函数或变量创建与外部环境的连接，这这个连接形成<code>作用域链</code>。<code>作用链</code>告诉执行上下文它应该包含什么，以及它应该在哪里查找解析函数的引用和变量的值。</p></li> <li><p>扫描<code>作用链</code>后，将创建一个环境存储器，其中<code>全局上下文</code>、<code>变量</code>、<code>函数及函数参数</code>的创建和引用在内存中完成。</p></li> <li><p>最后，在第一步中创建的每个执行上下文中确定 <code>this</code> 关键字的值。</p></li></ul> <p><strong>每个执行上下文包含了三个重要属性：<code>变量对象（VO）</code>、<code>作用域链</code>、<code>this</code>。</strong></p> <p>创建阶段伪代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>createContext <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 创建阶段</span>
  <span class="token string">'outerEnvironmentConnection'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 创建外部连接</span>
        <span class="token comment">// 形成作用域链</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>    
   <span class="token string">'variableObjectMapping'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 变量、函数和函数参数的创建和引用在内存中完成。</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token string">'valueOfThis'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 确定 this 的值</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>执行阶段：</strong></p> <p><code>执行阶段</code>是代码在创建阶段形成的执行上下文中的运行的阶段，并且逐行分配变量值。</p> <p>当执行开始时，JavaScript 引擎在其创建阶段形成的<code>AO对象</code>中查找执行函数的引用。如果在当前对象中没有找到，它将沿着作用域继续向上查找，直到它到达全局环境。</p> <p>如果在全局环境中找不到函数引用，则将返回错误。</p> <p>如果找到了引用并且函数正确执行，那么这个特定函数的执行上下文将从栈中弹出，接着 JavaScript 引擎将移动到下一个函数，它们的函数执行上下文将被加入到栈中并执行，以此类推。</p> <p>下面结合代码来理解<code>两种执行上下文</code>的<code>两个阶段</code>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;webinfoq&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token string">&quot;execution context&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> author <span class="token operator">=</span> <span class="token string">&quot;deepak&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token function-variable function">func2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> fixed <span class="token operator">=</span> <span class="token string">&quot;Divine&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">addFive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>因此<code>全局执行上下文</code>的<code>创建阶段</code>将如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>globalExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">// 全局执行上下文</span>
    outerEnvironmentConnection<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>  <span class="token comment">// 全局上下文外部环境为 null</span>
    variableObjectMapping<span class="token punctuation">:</span> <span class="token punctuation">{</span> 
        name<span class="token punctuation">:</span> uninitialized<span class="token punctuation">,</span>  <span class="token comment">// 在创建阶段，let 声明的变量是未初始化状态</span>
        title<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>     <span class="token comment">// 在创建阶段，var 声明的变量表示为未定义</span>
        date<span class="token punctuation">:</span> uninitialized<span class="token punctuation">,</span>  <span class="token comment">// 在创建阶段，const 声明的变量是未初始化状态</span>
        func1<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;func1 reference&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>  <span class="token comment">// func1 地址引用</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">:</span> window <span class="token comment">// Global Object  </span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>在<code>执行阶段</code>完成对变量的赋值等操作：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>globalExectutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">// 全局执行上下文</span>
    outerEnvironmentConnection<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 全部上下文外部环境为 null</span>
    variableObjectMapping<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;webinfoq&quot;</span><span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> <span class="token string">&quot;execution context&quot;</span><span class="token punctuation">,</span>
        message<span class="token punctuation">:</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">,</span>
        func1<span class="token punctuation">:</span> pointer to <span class="token keyword">function</span> func1<span class="token punctuation">,</span> <span class="token comment">// 指向 func1 的指针</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">:</span> window <span class="token comment">//Global Object</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>当执行到 <code>func1</code> 时，将形成新的<code>函数执行上下文</code>，<code>创建阶段</code>如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>func1ExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">// func1 函数执行上下文</span>
    outerEnvironmentConnection<span class="token punctuation">:</span> Global<span class="token punctuation">,</span>  <span class="token comment">// 外部环境为全局环境</span>
    variableObjectMapping<span class="token punctuation">:</span> <span class="token punctuation">{</span>
       arguments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            length<span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        num<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        author<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>  <span class="token comment">// var 声明的</span>
        value<span class="token punctuation">:</span> uninitialized<span class="token punctuation">,</span>  <span class="token comment">// let 声明的</span>
        func2<span class="token punctuation">:</span> uninitialized<span class="token punctuation">,</span>  <span class="token comment">// let 声明的</span>
        fixed<span class="token punctuation">:</span> uninitialized<span class="token punctuation">,</span>  <span class="token comment">// const 声明</span>
        addFive<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;addFive reference&gt;</span><span class="token template-punctuation string">`</span></span>  <span class="token comment">// addFive 地址引用</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">:</span> Global Object or <span class="token keyword">undefined</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>执行阶段</code>如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>func1ExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
    outerEnvironmentConnection<span class="token punctuation">:</span> Global<span class="token punctuation">,</span>  
    variableObjectMapping<span class="token punctuation">:</span> <span class="token punctuation">{</span>
       arguments<span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token comment">// 先处理 arguments 参数</span>
            <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            length<span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        num<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        author<span class="token punctuation">:</span> <span class="token string">&quot;deepak&quot;</span><span class="token punctuation">,</span>  <span class="token comment">//变量赋值</span>
        val<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        func2<span class="token punctuation">:</span> pointer to <span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        fixed<span class="token punctuation">:</span> <span class="token string">&quot;Divine&quot;</span>
        addFive<span class="token punctuation">:</span> pointer to <span class="token keyword">function</span> <span class="token function">addFive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">:</span> Global Object or <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>最后：</strong></p> <p>Javascript 引擎创建执行上下文，调用栈。当有函数执行时，引擎就会创建一个新的函数执行上下文。最后所用函数执行完成后，将更新全局环境，然后全局代码完成，程序结束。</p> <h2 id="_2-理解-javascript-执行上下文栈，可以应用堆栈信息快速定位问题。"><a href="#_2-理解-javascript-执行上下文栈，可以应用堆栈信息快速定位问题。" aria-hidden="true" class="header-anchor">#</a> 2. 理解 JavaScript 执行上下文栈，可以应用堆栈信息快速定位问题。</h2> <p>通过阅读上一小节我们得知，每当有函数执行时，就会创建一个全新的<code>执行上下文</code>，那么怎么管理这些执行上下文呢？</p> <p>JavaScript 引擎创建了<strong>执行上下文栈</strong> <code>Execution Context Stack</code> 来管理执行上下文。</p> <p>可以把执行栈认为成一个储存函数调用的栈结构，遵循先进后出的原则。</p> <p>下图为<code>执行上下文</code>入栈出栈示意图：</p> <p><img src="https://i.loli.net/2019/09/23/twsk5g6oaOBFEVq.gif" alt="入栈出栈示意图"></p> <p><strong>JavaScript 引擎是单线程执行，所有代码都是排队执行：</strong></p> <ul><li><p>一开始执行的是全局代码，首先创建<code>全局执行上下文</code>，然后将该执行上下文压入执行栈中。</p></li> <li><p>当执行一个函数，就会创建该<code>函数执行上下文</code>，然后将其压入执行栈的顶部。</p></li> <li><p>函数执行完成后，执行上下文从底部退出，等待垃圾回收。</p></li></ul> <p><strong>调用栈的应用：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>你可以把调用栈想象成一个函数调用链，就像我们在前面代码段的注释中所写的一样。
另一个查看调用栈的方法是使用浏览器的调试工具。绝大多数现代桌面浏览器都内置了开发者工具， 其中包含 JavaScript 调试器。
就本例来说，你可以在工具中给 <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 函数的第一行代码设置一个断点，或者直接在第一行代码之前插入一条 <span class="token keyword">debugger</span> 语句。
运行代码时，调试器会在那个位置暂停，同时会展示当前位置的函数调用列表，这就是你的调用栈。
因此，如果你想要分析 <span class="token keyword">this</span> 的绑定，使用开 发者工具得到调用栈，然后找到栈中第二个元素，这就是真正的调用位置。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <span id="footerPost" data-v-3a18dd0a></span></div> <div id="post-toc" class="post-toc el-col el-col-6" data-v-3a18dd0a><div class="catalog-body" data-v-3a18dd0a><h4 class="catalog-title" data-v-3a18dd0a>目录</h4> <ul id="catalog-list" class="catalog-list" data-v-3a18dd0a></ul></div></div></div> <div class="el-row is-justify-center el-row--flex" data-v-3a18dd0a><div class="post-card vssue-wrap el-col el-col-21 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-3a18dd0a></div></div> <div class="post-nav el-row is-justify-space-around el-row--flex" data-v-3a18dd0a><div class="post-prev el-col el-col-7" data-v-3a18dd0a><div data-v-3a18dd0a><a href="/posts/Chapter1/this.html" data-v-3a18dd0a><i class="el-icon-arrow-left" data-v-3a18dd0a></i> Prev
        </a> <p class="nav-title" data-v-3a18dd0a>this</p></div></div> <div class="post-next el-col el-col-7 el-col-lg-pull-5" data-v-3a18dd0a><div data-v-3a18dd0a><a href="/posts/Chapter1/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0.html" data-v-3a18dd0a>
          Next
          <i class="el-icon-arrow-right" data-v-3a18dd0a></i></a> <p class="nav-title" data-v-3a18dd0a>高阶函数</p></div></div></div> <span data-v-3f1acc1c data-v-3a18dd0a><button type="button" class="el-button toc-btn el-button--primary el-button--mini is-circle" data-v-3f1acc1c><!----><!----><span><i class="el-icon-tickets" data-v-3f1acc1c></i></span></button> <button type="button" class="el-button gotop-btn el-button--primary is-circle" data-v-3f1acc1c><!----><!----><span><i class="el-icon-arrow-up" data-v-3f1acc1c></i></span></button></span></div></main></section> <button type="button" class="el-button gotop-btn el-button--primary is-circle" style="display:none;" data-v-1918517c data-v-8ae45032><!----><!----><span><i class="el-icon-arrow-up" data-v-1918517c></i></span></button></section> <div class="overlay" data-v-8ae45032></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e48c3d44.js" defer></script><script src="/assets/js/1.9aa2b147.js" defer></script><script src="/assets/js/6.ab6f709e.js" defer></script><script src="/assets/js/5.0f5d195d.js" defer></script><script src="/assets/js/8.b943e6ee.js" defer></script><script src="/assets/js/11.fb958432.js" defer></script><script src="/assets/js/7.a46ab4a3.js" defer></script><script src="/assets/js/34.5b4ce795.js" defer></script><script src="/assets/js/16.f738196f.js" defer></script>
  </body>
</html>
